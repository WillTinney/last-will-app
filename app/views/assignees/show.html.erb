<% content_for(:navbar) do %>
  <%= render 'shared/navbar' %>
<% end %>

<% content_for(:sidebar) do %>
  <%= render 'shared/sidebars/sidebar_assignee' %>
<% end %>

<div class="dashboard-box" style="background-image: linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.2) 50%), url(<%= asset_path('background.jpg') %>)">
  <div id="tab-content">
    <div class="container">
      <br>
      <div class="grey-box">
        <br>
        <%= link_to '#', class: 'profile-picture-inline' do %>

          <% if @assignee.profile_picture %>
            <%= cl_image_tag(@assignee.profile_picture.path, transformation: [{width: 120, height: 120, gravity: "face", radius: "max", crop: "fill"}], class: "avatar-edit") %>
          <% elsif @assignee.relationship == 'Partner' %>
            <% if @user.title == "Mr" %>
              <%= image_tag('female.png', class: "edit-icon") %>
            <% else %>
              <%= image_tag('male.png', class: "edit-icon") %>
            <% end %>
          <% elsif %>
            <% if @assignee.relationship == "Child"%>
              <%= image_tag('girl.png', class: "edit-icon") %>
            <% else %>
              <%= image_tag('boy.png', class: "edit-icon") %>
            <% end %>
          <% else %>
            <% if @assignee.title == "Mrs" || @assignee.title == "Ms" %>
              <%= image_tag('guardian_female.png', class: "edit-icon") %>
            <% else %>
              <%= image_tag('guardian_male.png', class: "edit-icon") %>
            <% end %>
          <% end %>

          <p><%= t('Change Picture') %></p>
          <%= simple_form_for [current_user, @assignee], html: {class: 'form-inline edit-profile-picture invisible'} do |f| %>
            <%= f.input :profile_picture, as: :attachinary, label: false, input_html: { class: 'profile-upload'} %>
            <%= f.submit t("Upload"), class: 'profile-upload'  %>
          <% end %>
        <% end %>

        <% if params[:format] == 'Guardian' || @assignee.type == 'Guardian' %>
          <h3 class="new-title padding-15">Guardian</h3>
        <% elsif params[:format] == 'Approver' || @assignee.type == 'Approver' %>
          <h3 class="new-title padding-15">Approver</h3>
        <% elsif params[:relationship] == 'Partner' || @assignee.relationship == 'Partner' %>
          <h3 class="new-title padding-15">Partner</h3>
        <% elsif params[:relationship] == 'Child' || @assignee.relationship == 'Child' %>
          <h3 class="new-title padding-15">Child</h3>
        <% else %>
          <h3 class="new-title padding-15"><%= @assignee.relationship %></h3>
        <% end %>

        <hr>
        Details
        <hr>
        Notes
        <hr>
        Photos
        <hr>
        Admin References
        <hr>

        <br>

      </div>
    </div>
  </div>
</div>

<% content_for(:after_js) do %>
  <script>
    // Changes active scrollmenu user
    $('.scrollbox').children().removeClass("active");

    var assigneeId = <%= @assignee.id %>

    $('.scrollitem h6').filter(function () {
        return $(this).text() == assigneeId;
    }).parentsUntil('.scrollmenu').addClass('active');

    // Edit profile picture form
    $('.profile-picture-inline').click(function(e) {
      e.preventDefault;
      console.log('hello')
      $('.edit-profile-picture').removeClass('invisible');
    });
  </script>
<% end %>
